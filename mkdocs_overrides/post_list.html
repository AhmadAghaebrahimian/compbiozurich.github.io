{% extends "base.html" %}

--------------------------------------------------------------------------------
The list page will process individual pages which:

* have a match of the list page's `page.meta.path_element` in their url
* have a date in their `meta`

--------------------------------------------------------------------------------

{% block content %}

  {{ page.content }}

  {% set today = build_date_utc.strftime('%Y%m%d') | int %}

  {% set future_posts = [] %}
  {% set news_posts = [] %}
  
  {% for this_file in pages %}
    {% set this_page = this_file.page %}
    {% if this_page.meta is defined %}
      {% if this_page.meta.date is defined %}
        {% if page.meta.path_element in this_page.url %}
          {% set page_date = this_page.meta.date.strftime('%Y%m%d') | int %}
          {% if page_date > today %}
            {{ future_posts.append( this_page ) or "" }}
          {% else %}
            {{ news_posts.append( this_page ) or "" }}
          {% endif %}
        {% endif %}
      {% endif %}
    {% endif %}
  {% endfor %}

<!--
First, upcoming events are processed with the "oldes" (i.e. closest in the
future) first if any exist
-->

  {% if future_posts|length > 0 %}
  <h2>Upcoming</h2>
    {% for post_page in (future_posts |sort(attribute="meta.date", reverse=False))[:config.extra.blog_list_length] %}
      {% include "partials/post_preview.html" %}
    {% endfor %}
  {% endif %}

<!--
Then, previous events are processed with the latest first
-->

  <h2>Previous</h2>

  {% for post_page in (news_posts|sort(attribute="meta.date", reverse=True))[:config.extra.blog_list_length] %}
    {% include "partials/post_preview.html" %}
  {% endfor %}

{% endblock %}
